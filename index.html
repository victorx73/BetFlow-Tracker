<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Apostas</title>

<style>
:root {
  --primary: #0099ff;
  --primary-dark: #007acc;
  --success: #00cc88;
  --success-dark: #00aa66;
  --danger: #ff5555;
  --danger-dark: #cc4444;
  --warning: #ffaa00;
  --warning-dark: #cc8800;
  --dark-bg: #0a0e14;
  --card-bg: #151a24;
  --card-border: #2a3245;
  --text: #f0f6fc;
  --text-secondary: #8b949e;
  --accent: #6e40c9;
  --accent-light: #8a6dff;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  background: var(--dark-bg);
  color: var(--text);
  line-height: 1.6;
  padding: 20px;
  background-image: 
    radial-gradient(circle at 10% 20%, rgba(0, 153, 255, 0.05) 0%, transparent 20%),
    radial-gradient(circle at 90% 80%, rgba(108, 64, 201, 0.05) 0%, transparent 20%);
  min-height: 100vh;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
}

.header {
  text-align: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid var(--card-border);
  position: relative;
}

.header h1 {
  font-size: 2.8rem;
  background: linear-gradient(90deg, var(--primary), var(--accent-light));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  margin-bottom: 8px;
  font-weight: 800;
  letter-spacing: -0.5px;
}

.header p {
  color: var(--text-secondary);
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
}

.header-controls {
  position: absolute;
  right: 0;
  top: 0;
  display: flex;
  gap: 10px;
}

.btn-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--card-border);
  color: var(--text);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.btn-icon:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
}

.main-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 25px;
  margin-bottom: 30px;
}

.card {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 25px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  border: 1px solid var(--card-border);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  overflow: hidden;
  position: relative;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
}

.card h3 {
  font-size: 1.3rem;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  color: var(--text);
  font-weight: 600;
}

.card h3 i {
  color: var(--primary);
  font-size: 1.2rem;
}

.input-group {
  margin-bottom: 20px;
}

.input-group label {
  display: block;
  margin-bottom: 8px;
  color: var(--text-secondary);
  font-size: 0.95rem;
  font-weight: 500;
}

input, button, textarea {
  width: 100%;
  padding: 14px 16px;
  border-radius: 10px;
  border: none;
  font-size: 16px;
  font-family: inherit;
  transition: all 0.2s ease;
}

input {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid var(--card-border);
  color: var(--text);
}

input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(0, 153, 255, 0.2);
  background: rgba(0, 153, 255, 0.02);
}

button {
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  letter-spacing: 0.3px;
}

button i {
  font-size: 1.1rem;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
}

.btn-primary:hover {
  background: linear-gradient(135deg, var(--primary-dark), var(--primary));
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 153, 255, 0.3);
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.05);
  color: var(--text);
  border: 1px solid var(--card-border);
}

.btn-secondary:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
}

.btn-success {
  background: linear-gradient(135deg, var(--success), var(--success-dark));
  color: #000;
  border: none;
}

.btn-success:hover {
  background: linear-gradient(135deg, var(--success-dark), var(--success));
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 204, 136, 0.3);
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger), var(--danger-dark));
  color: white;
  border: none;
}

.btn-danger:hover {
  background: linear-gradient(135deg, var(--danger-dark), var(--danger));
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255, 85, 85, 0.3);
}

.btn-warning {
  background: linear-gradient(135deg, var(--warning), var(--warning-dark));
  color: #000;
  border: none;
}

.btn-warning:hover {
  background: linear-gradient(135deg, var(--warning-dark), var(--warning));
  transform: translateY(-2px);
}

.bets-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  flex-wrap: wrap;
  gap: 10px;
}

.sort-options {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.sort-btn {
  width: auto;
  padding: 8px 12px;
  font-size: 0.85rem;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-secondary);
  border: 1px solid var(--card-border);
}

.sort-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.bets-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 12px;
  margin-top: 10px;
}

.bet-btn {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid var(--card-border);
  color: var(--text);
  padding: 15px 12px;
  border-radius: 10px;
  font-weight: 600;
  transition: all 0.2s ease;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.bet-btn:hover {
  background: rgba(0, 153, 255, 0.08);
  border-color: var(--primary);
  transform: translateY(-2px);
}

.bet-btn.active {
  background: linear-gradient(135deg, rgba(0, 204, 136, 0.9), rgba(0, 170, 102, 0.9));
  color: #000;
  border-color: var(--success);
  box-shadow: 0 5px 15px rgba(0, 204, 136, 0.3);
}

.bet-value {
  font-size: 1.1rem;
  margin-bottom: 5px;
  font-weight: 700;
}

.bet-return {
  font-size: 0.9rem;
  opacity: 0.9;
}

.bet-odds {
  position: absolute;
  top: 5px;
  right: 5px;
  font-size: 0.7rem;
  background: rgba(0, 0, 0, 0.3);
  padding: 3px 6px;
  border-radius: 4px;
  font-weight: 600;
}

.bet-index {
  position: absolute;
  top: 5px;
  left: 5px;
  font-size: 0.7rem;
  opacity: 0.6;
  font-weight: 600;
}

.result-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 10px;
}

.date-filters {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 20px;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.stat-card {
  background: rgba(255, 255, 255, 0.03);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  border: 1px solid var(--card-border);
  transition: transform 0.2s ease;
}

.stat-card:hover {
  transform: translateY(-3px);
  border-color: var(--primary);
}

.stat-card h4 {
  font-size: 0.95rem;
  color: var(--text-secondary);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.stat-value {
  font-size: 2rem;
  font-weight: 800;
}

.stat-positive {
  color: var(--success);
}

.stat-negative {
  color: var(--danger);
}

.stat-neutral {
  color: var(--text);
}

.lucro-card {
  grid-column: 1 / -1;
  background: linear-gradient(135deg, rgba(0, 153, 255, 0.1), rgba(108, 64, 201, 0.1));
  border: 1px solid rgba(0, 153, 255, 0.3);
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-secondary);
  grid-column: 1 / -1;
}

.empty-state i {
  font-size: 3.5rem;
  margin-bottom: 15px;
  opacity: 0.3;
}

.empty-state p {
  font-size: 1.1rem;
}

.import-export-section {
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid var(--card-border);
}

.json-input {
  font-family: 'Monaco', 'Consolas', monospace;
  font-size: 14px;
  min-height: 150px;
  resize: vertical;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid var(--card-border);
  color: var(--text);
  margin-bottom: 15px;
}

.json-input:focus {
  border-color: var(--primary);
  outline: none;
}

.data-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 20px;
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(5px);
}

.modal-content {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 30px;
  max-width: 500px;
  width: 90%;
  border: 1px solid var(--card-border);
  position: relative;
  animation: modalIn 0.3s ease;
}

.modal h3 {
  margin-bottom: 20px;
  color: var(--text);
}

.modal-close {
  position: absolute;
  top: 20px;
  right: 20px;
  background: none;
  border: none;
  color: var(--text-secondary);
  font-size: 1.5rem;
  cursor: pointer;
  width: 30px;
  height: 30px;
}

.modal-close:hover {
  color: var(--text);
}

@keyframes modalIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

footer {
  text-align: center;
  margin-top: 40px;
  padding-top: 20px;
  border-top: 1px solid var(--card-border);
  color: var(--text-secondary);
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .main-grid {
    grid-template-columns: 1fr;
  }
  
  .header h1 {
    font-size: 2.2rem;
  }
  
  .header-controls {
    position: relative;
    justify-content: center;
    margin-top: 15px;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .bets-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 15px;
  }
  
  .sort-options {
    width: 100%;
    justify-content: space-between;
  }
  
  .data-actions {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .date-filters, .result-buttons {
    grid-template-columns: 1fr;
  }
  
  .bets-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .sort-options {
    flex-wrap: wrap;
  }
  
  .sort-btn {
    flex: 1;
    min-width: 80px;
  }
}
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>

<body>
<div class="container">
  <header class="header">
    <h1>üéØ Controle de Apostas</h1>
    <p>Gerencie suas apostas, analise resultados e maximize seus lucros</p>
    <div class="header-controls">
      <button class="btn-icon" onclick="exportarDados()" title="Exportar dados">
        <i class="fas fa-download"></i>
      </button>
      <button class="btn-icon" onclick="abrirModal('importModal')" title="Importar dados">
        <i class="fas fa-upload"></i>
      </button>
      <button class="btn-icon" onclick="limparDados()" title="Limpar todos os dados">
        <i class="fas fa-trash-alt"></i>
      </button>
    </div>
  </header>
  
  <div class="main-grid">
    <div class="card">
      <h3><i class="fas fa-plus-circle"></i> Nova Aposta</h3>
      <div class="input-group">
        <label for="valor"><i class="fas fa-money-bill-wave"></i> Valor Apostado (R$)</label>
        <input type="number" id="valor" placeholder="Ex: 1.50" step="0.01" min="0.01">
      </div>
      <div class="input-group">
        <label for="retorno"><i class="fas fa-coins"></i> Retorno Potencial (R$)</label>
        <input type="number" id="retorno" placeholder="Ex: 2.00" step="0.01" min="0.01">
      </div>
      <button class="btn-primary" onclick="addAposta()">
        <i class="fas fa-save"></i> Adicionar Aposta
      </button>
    </div>
    
    <div class="card">
      <div class="bets-header">
        <h3><i class="fas fa-list"></i> Apostas Cadastradas</h3>
        <div class="sort-options">
          <span style="color: var(--text-secondary); font-size: 0.9rem;">Ordenar:</span>
          <button class="sort-btn active" onclick="ordenarApostas('valor', 'asc')">
            <i class="fas fa-sort-amount-down-alt"></i> Valor
          </button>
          <button class="sort-btn" onclick="ordenarApostas('retorno', 'desc')">
            <i class="fas fa-sort-amount-down"></i> Retorno
          </button>
          <button class="sort-btn" onclick="ordenarApostas('odds', 'desc')">
            <i class="fas fa-chart-line"></i> Odds
          </button>
        </div>
      </div>
      <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem;">
        Selecione uma aposta para registrar o resultado:
      </p>
      <div class="bets-grid" id="listaApostas"></div>
    </div>
    
    <div class="card">
      <h3><i class="fas fa-flag-checkered"></i> Registrar Resultado</h3>
      <p id="aposta-selecionada-info" style="margin-bottom: 20px; color: var(--text-secondary); font-style: italic;">
        <i class="fas fa-info-circle"></i> Nenhuma aposta selecionada
      </p>
      <div class="result-buttons">
        <button class="btn-success" onclick="registrar('vitoria')">
          <i class="fas fa-trophy"></i> Vit√≥ria
        </button>
        <button class="btn-danger" onclick="registrar('derrota')">
          <i class="fas fa-times-circle"></i> Derrota
        </button>
      </div>
    </div>
  </div>
  
  <div class="card">
    <h3><i class="fas fa-chart-line"></i> Estat√≠sticas e Filtros</h3>
    
    <div class="date-filters">
      <div class="input-group">
        <label for="inicio"><i class="fas fa-calendar-alt"></i> Data Inicial</label>
        <input type="date" id="inicio">
      </div>
      <div class="input-group">
        <label for="fim"><i class="fas fa-calendar-alt"></i> Data Final</label>
        <input type="date" id="fim">
      </div>
    </div>
    
    <button class="btn-primary" onclick="filtrar()" style="margin-bottom: 30px;">
      <i class="fas fa-filter"></i> Aplicar Filtro
    </button>
    
    <div class="stats-grid">
      <div class="stat-card">
        <h4><i class="fas fa-gamepad"></i> Partidas</h4>
        <div class="stat-value stat-neutral" id="p">0</div>
      </div>
      
      <div class="stat-card">
        <h4><i class="fas fa-check-circle"></i> Vit√≥rias</h4>
        <div class="stat-value stat-positive" id="v">0</div>
      </div>
      
      <div class="stat-card">
        <h4><i class="fas fa-times-circle"></i> Derrotas</h4>
        <div class="stat-value stat-negative" id="d">0</div>
      </div>
      
      <div class="stat-card">
        <h4><i class="fas fa-hand-holding-usd"></i> Total Apostado</h4>
        <div class="stat-value stat-neutral">R$ <span id="apostado">0.00</span></div>
      </div>
      
      <div class="stat-card">
        <h4><i class="fas fa-money-check-alt"></i> Total Ganho</h4>
        <div class="stat-value stat-positive">R$ <span id="ganho">0.00</span></div>
      </div>
      
      <div class="stat-card lucro-card">
        <h4><i class="fas fa-chart-bar"></i> Lucro L√≠quido</h4>
        <div class="stat-value" id="l">R$ 0.00</div>
      </div>
    </div>
    
    <div class="import-export-section">
      <h3><i class="fas fa-database"></i> Gerenciar Dados</h3>
      <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem;">
        Fa√ßa backup ou restaure seus dados de apostas
      </p>
      <div class="data-actions">
        <button class="btn-warning" onclick="exportarDados()">
          <i class="fas fa-file-export"></i> Exportar Dados
        </button>
        <button class="btn-secondary" onclick="abrirModal('importModal')">
          <i class="fas fa-file-import"></i> Importar Dados
        </button>
      </div>
    </div>
  </div>
  
  <footer>
    <p>Controle de Apostas &copy; 2023 | Dados salvos automaticamente no navegador</p>
  </footer>
</div>

<div id="importModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="fecharModal('importModal')">&times;</button>
    <h3><i class="fas fa-file-import"></i> Importar Dados</h3>
    <div class="input-group">
      <label for="jsonInput"><i class="fas fa-code"></i> Cole o JSON aqui:</label>
      <textarea id="jsonInput" class="json-input" placeholder='{"apostas": [...], "historico": [...]}'></textarea>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      <button class="btn-primary" onclick="importarDados()">
        <i class="fas fa-check"></i> Importar
      </button>
      <button class="btn-secondary" onclick="fecharModal('importModal')">
        <i class="fas fa-times"></i> Cancelar
      </button>
    </div>
  </div>
</div>

<div id="confirmModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="fecharModal('confirmModal')">&times;</button>
    <h3><i class="fas fa-exclamation-triangle"></i> Confirma√ß√£o</h3>
    <p id="confirmMessage" style="margin-bottom: 20px;"></p>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      <button class="btn-danger" id="confirmAction">
        <i class="fas fa-check"></i> Confirmar
      </button>
      <button class="btn-secondary" onclick="fecharModal('confirmModal')">
        <i class="fas fa-times"></i> Cancelar
      </button>
    </div>
  </div>
</div>

<script>
let apostas = JSON.parse(localStorage.getItem("valores")) || [];
let historico = JSON.parse(localStorage.getItem("apostas")) || [];
let apostaSelecionada = null;
let ordenacaoAtual = { campo: 'valor', direcao: 'asc' };

function ordenarApostas(campo, direcao) {
  ordenacaoAtual = { campo, direcao };
  
  document.querySelectorAll('.sort-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  
  const buttons = document.querySelectorAll('.sort-btn');
  if (campo === 'valor' && direcao === 'asc') {
    buttons[0].classList.add('active');
  } else if (campo === 'retorno' && direcao === 'desc') {
    buttons[1].classList.add('active');
  } else if (campo === 'odds' && direcao === 'desc') {
    buttons[2].classList.add('active');
  }
  
  apostas.sort((a, b) => {
    let valorA, valorB;
    
    if (campo === 'odds') {
      valorA = a.retorno / a.valor;
      valorB = b.retorno / b.valor;
    } else {
      valorA = a[campo];
      valorB = b[campo];
    }
    
    if (direcao === 'asc') {
      return valorA - valorB;
    } else {
      return valorB - valorA;
    }
  });
  
  salvar();
  renderApostas();
}

function hoje() {
  return new Date().toISOString().split("T")[0];
}

function salvar() {
  localStorage.setItem("valores", JSON.stringify(apostas));
  localStorage.setItem("apostas", JSON.stringify(historico));
  showFeedback('Dados salvos com sucesso!', 'success');
}

function addAposta() {
  let valor = parseFloat(document.getElementById("valor").value);
  let retorno = parseFloat(document.getElementById("retorno").value);
  
  if (isNaN(valor) || isNaN(retorno) || valor <= 0 || retorno <= 0) {
    showFeedback("Por favor, preencha valores v√°lidos e positivos", "error");
    return;
  }
  
  if (retorno <= valor) {
    showFeedback("O retorno deve ser maior que o valor apostado!", "error");
    return;
  }
  
  apostas.push({ valor, retorno });
  
  ordenarApostas('valor', 'asc');
  
  document.getElementById("valor").value = '';
  document.getElementById("retorno").value = '';
  
  showFeedback('Aposta adicionada e ordenada por valor!', 'success');
}

function renderApostas() {
  let div = document.getElementById("listaApostas");
  div.innerHTML = "";
  
  if (apostas.length === 0) {
    div.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-clipboard-list"></i>
        <p>Nenhuma aposta cadastrada.</p>
        <p style="font-size: 0.9rem; margin-top: 5px;">Adicione uma nova aposta acima.</p>
      </div>
    `;
    return;
  }
  
  apostas.forEach((a, index) => {
    let b = document.createElement("button");
    b.className = "bet-btn";
    
    let odds = (a.retorno / a.valor).toFixed(2);
    let lucroPotencial = (a.retorno - a.valor).toFixed(2);
    
    b.innerHTML = `
      <div class="bet-index">#${index + 1}</div>
      <div class="bet-odds">${odds}x</div>
      <div class="bet-value">R$ ${a.valor.toFixed(2)}</div>
      <div class="bet-return">‚Üí R$ ${a.retorno.toFixed(2)}</div>
      <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.7;">+R$ ${lucroPotencial}</div>
    `;
    
    b.onclick = () => {
      apostaSelecionada = a;
      document.querySelectorAll(".bet-btn").forEach(btn => btn.classList.remove("active"));
      b.classList.add("active");
      
      document.getElementById("aposta-selecionada-info").innerHTML = `
        <i class="fas fa-check-circle" style="color: var(--success);"></i> 
        <strong>Aposta selecionada:</strong> R$ ${a.valor.toFixed(2)} 
        <br><span style="font-size: 0.9rem;">Retorno: R$ ${a.retorno.toFixed(2)} | Odds: ${odds}x | Lucro potencial: R$ ${lucroPotencial}</span>
      `;
    };
    div.appendChild(b);
  });
}

function registrar(resultado) {
  if (!apostaSelecionada) {
    showFeedback("Por favor, selecione uma aposta antes de registrar o resultado.", "error");
    return;
  }

  historico.push({
    data: hoje(),
    resultado,
    valor: apostaSelecionada.valor,
    retorno: apostaSelecionada.retorno
  });

  salvar();
  filtrar();
  
  if (resultado === "vitoria") {
    showFeedback('üèÜ Vit√≥ria registrada com sucesso!', 'success');
  } else {
    showFeedback('‚ùå Derrota registrada.', 'error');
  }
}

function exportarDados() {
  const dados = {
    apostas: apostas,
    historico: historico,
    exportadoEm: new Date().toISOString(),
    totalApostas: apostas.length,
    totalRegistros: historico.length
  };
  
  const jsonString = JSON.stringify(dados, null, 2);
  const blob = new Blob([jsonString], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement('a');
  a.href = url;
  a.download = `apostas_backup_${new Date().toISOString().split('T')[0]}.json`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  showFeedback('Dados exportados com sucesso!', 'success');
}

function importarDados() {
  const jsonInput = document.getElementById('jsonInput').value;
  
  if (!jsonInput.trim()) {
    showFeedback('Por favor, cole o JSON para importar.', 'error');
    return;
  }
  
  try {
    const dados = JSON.parse(jsonInput);
    
    if (!dados.apostas || !Array.isArray(dados.apostas) || 
        !dados.historico || !Array.isArray(dados.historico)) {
      throw new Error('Formato JSON inv√°lido. Esperado: {"apostas": [...], "historico": [...]}');
    }
    
    abrirConfirmacao(
      `Importar ${dados.apostas.length} apostas e ${dados.historico.length} registros hist√≥ricos?`,
      () => {
        apostas = dados.apostas;
        historico = dados.historico;
        salvar();
        ordenarApostas('valor', 'asc');
        filtrar();
        fecharModal('importModal');
        showFeedback('Dados importados com sucesso!', 'success');
      }
    );
    
  } catch (error) {
    showFeedback(`Erro ao importar: ${error.message}`, 'error');
  }
}

function limparDados() {
  abrirConfirmacao(
    'Tem certeza que deseja limpar TODOS os dados? Esta a√ß√£o n√£o pode ser desfeita.',
    () => {
      apostas = [];
      historico = [];
      apostaSelecionada = null;
      salvar();
      renderApostas();
      filtrar();
      showFeedback('Todos os dados foram limpos.', 'success');
    }
  );
}

function abrirModal(modalId) {
  document.getElementById(modalId).style.display = 'flex';
}

function fecharModal(modalId) {
  document.getElementById(modalId).style.display = 'none';
  if (modalId === 'importModal') {
    document.getElementById('jsonInput').value = '';
  }
}

function abrirConfirmacao(mensagem, acaoConfirmar) {
  document.getElementById('confirmMessage').textContent = mensagem;
  const confirmBtn = document.getElementById('confirmAction');
  
  const novoConfirmBtn = confirmBtn.cloneNode(true);
  confirmBtn.parentNode.replaceChild(novoConfirmBtn, confirmBtn);
  
  novoConfirmBtn.addEventListener('click', () => {
    acaoConfirmar();
    fecharModal('confirmModal');
  });
  
  abrirModal('confirmModal');
}

function showFeedback(mensagem, tipo) {
  const feedback = document.createElement("div");
  feedback.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 12px;
    color: white;
    font-weight: 600;
    z-index: 1000;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    animation: slideIn 0.3s ease;
    max-width: 350px;
    backdrop-filter: blur(10px);
  `;
  
  if (tipo === 'success') {
    feedback.style.background = "rgba(0, 204, 136, 0.9)";
    feedback.innerHTML = `<i class="fas fa-check-circle"></i> ${mensagem}`;
  } else if (tipo === 'error') {
    feedback.style.background = "rgba(255, 85, 85, 0.9)";
    feedback.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${mensagem}`;
  } else {
    feedback.style.background = "rgba(0, 153, 255, 0.9)";
    feedback.innerHTML = `<i class="fas fa-info-circle"></i> ${mensagem}`;
  }
  
  document.body.appendChild(feedback);
  
  setTimeout(() => {
    feedback.style.animation = "slideOut 0.3s ease";
    setTimeout(() => feedback.remove(), 300);
  }, 3000);
}

function filtrar() {
  let inicio = document.getElementById("inicio").value;
  let fim = document.getElementById("fim").value;

  let f = historico.filter(h => {
    if (inicio && h.data < inicio) return false;
    if (fim && h.data > fim) return false;
    return true;
  });

  let p=0, v=0, d=0, apostado=0, ganho=0;

  f.forEach(h => {
    p++;
    apostado += h.valor;
    if (h.resultado === "vitoria") {
      v++;
      ganho += h.retorno;
    } else {
      d++;
    }
  });

  let lucro = ganho - apostado;
  let lucroElement = document.getElementById("l");
  
  document.getElementById("p").innerText = p;
  document.getElementById("v").innerText = v;
  document.getElementById("d").innerText = d;
  document.getElementById("apostado").innerText = apostado.toFixed(2);
  document.getElementById("ganho").innerText = ganho.toFixed(2);
  lucroElement.innerText = `R$ ${lucro.toFixed(2)}`;
  
  if (lucro > 0) {
    lucroElement.className = "stat-value stat-positive";
  } else if (lucro < 0) {
    lucroElement.className = "stat-value stat-negative";
  } else {
    lucroElement.className = "stat-value stat-neutral";
  }
}

window.onload = function() {
  let hoje = new Date().toISOString().split("T")[0];
  let umaSemanaAtras = new Date();
  umaSemanaAtras.setDate(umaSemanaAtras.getDate() - 7);
  let umaSemanaAtrasStr = umaSemanaAtras.toISOString().split("T")[0];
  
  document.getElementById("inicio").value = umaSemanaAtrasStr;
  document.getElementById("fim").value = hoje;
  
  ordenarApostas('valor', 'asc');
  filtrar();
};

const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  @keyframes slideOut {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
  }
`;
document.head.appendChild(style);

window.onclick = function(event) {
  if (event.target.classList.contains('modal')) {
    event.target.style.display = 'none';
  }
};
</script>
</body>
</html>